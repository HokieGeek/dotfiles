#!/bin/sh

me="$(cd `dirname $0`; pwd)/`basename $0`"
[ "$1" = "--cron" ] && {
    cronjobs=/tmp/cronjobs.$$
    crontab -l > $cronjobs
    echo '*/4 * * * * '$me' $HOME/Dropbox/ip' >> $cronjobs
    crontab < $cronjobs
    crontab -l
    exit 0
}

wget -q -O /dev/stdout http://checkip.dyndns.org/ | cut -d : -f 2- | cut -d \< -f -1 | awk '{ print $1 }' > $1
