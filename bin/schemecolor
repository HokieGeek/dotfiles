#!/bin/sh

here=$(cd $(dirname $0); pwd)
me=${here}/$(basename $0)
[ $# -le 0 ] && {
    colors=$(${me} --colors | xargs | sed 's/\s/|/g')
    echo "USAGE: $(basename $0) [${colors}]"
    exit 1
}

case ${1} in
    purple) fg_hex="#5f0087"; fg_xterm="55"; ;;
      blue) fg_hex="#000087"; fg_xterm="18"; ;;
      cyan) fg_hex="#00d7af"; fg_xterm="43"; ;;
     green) fg_hex="#005f00"; fg_xterm="22"; ;;
     olive) fg_hex="#87af00"; fg_xterm="106"; ;;
    yellow) fg_hex="#ffff00"; fg_xterm="11"; ;;
    orange) fg_hex="#af5f00"; fg_xterm="130"; ;;
       red) fg_hex="#870000"; fg_xterm="88"; ;;
      grey) fg_hex="#9e9e9e"; fg_xterm="247"; ;;
     white) fg_hex="#ffffff"; fg_xterm="231"; ;;

  --colors) awk '$1 ~ /^\s*[a-z]*)/ { sub(/[^a-z]/, "", $1); print $1 }' ${me}
            exit 0
            ;;
         *) echo "ERROR: You're smoking crack"
            exit 2
            ;;
esac

## Update xmonad
sed "/colorForeground\s*=/s/\".*\"/\"${fg_hex}\"/g" -i ~/.xmonad/xmonad.hs
~/.xmonad/restart

## Update tmux
sed \
    -e "/window-status-current-format/s/colour[0-9]*/colour${fg_xterm}/" \
    -e "/pane-active-border-fg/s/colour[0-9]*/colour${fg_xterm}/" \
    -e "/message-bg/s/colour[0-9]*/colour${fg_xterm}/" \
    -i $(readlink ~/.tmux.conf)
tmux source-file ~/.tmux.conf >/dev/null 2>&1
